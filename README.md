# TCMF_doubleLockSafeBox
Demo video :
https://www.youtube.com/watch?v=JhpnjDdRhsA

Team Members
---

| Student ID   | Name                         | GitHub                                              | Affiliation                                              |
|--------------|------------------------------|-----------------------------------------------------|----------------------------------------------------------|
| 6210501010   | ภาณุพงศ์ เจริญพร               | [panupongChar](https://github.com/panupongChar)     | Computer Engineering, Kasetsart University               |
| 6210503691   | ปพนธ์ ชุณหคล้าย               | [canppchk](https://github.com/Nacjoker)             | Computer Engineering, Kasetsart University               |
| 6210503853   | สิทธิเจตน์ วงศ์ทิชาวัฒน์           | [ttimestj](https://github.com/Nieraa)               | Computer Engineering, Kasetsart University               |
| 6210505163   | จิณณเจตน์ อจลพงศ์             | [jinnajateA](https://github.com/jinnajateA)         | Computer Engineering, Kasetsart University               |

ชื่อโครงงาน: Double Lock Safe Box

รายละเอียด:
ตู้เซฟที่มีระบบการล็อค 2 ชั้น
โดยชั้นแรก จะปลดล็อคด้วยการกดปุ่มใส่รหัสผ่าน ทางHardware
ส่วนการปลดล็อคชั้นที่สอง จะพิมพ์รหัสผ่านทางsoftware (หน้าเว็บหรือหน้าจอคอม)
โดยการปลดล็อคหรือการพยายามใส่รหัสผ่านทุกๆครั้งจะเก็บ log file ไว้

ที่มาของโครงงาน :
ตู้เซฟแบบเก่ามีข้อจำกัดในการตั้งรหัสผ่าน และไม่สามารถติดตามได้ว่ามีการพยายามเปิดตู้เซฟในเวลาใดได้
เพื่อเพิ่มความปลอดภัยจากระบบการล็อคแบบเก่า พวกเราจึงคิดระบบการล็อคแบบสองชั้นขึ้น
โดยที่หน้าตู้เซฟมีการล็อครหัสถึง8หลักจากคีย์4แบบ และที่หน้าเว็บสามารถตั้งรหัสได้ไม่จำกัดจำนวนตัวอักษ
อีกทั้งยังมีการเก็บ log file เพื่อให้สามารถติดตามได้ว่ามีการพยายามเปิดตู้ในเวลาใด
และมีการแสดงรหัสที่ผิดเพื่อให้เจ้าของตู้นำไปประกอบการตัดสินใจเปลี่ยนรหัส

ลักษณะการทำงาน :
เมื่อเปิดเครื่อง หน้าตู้เซฟจะมีการรอรับรหัสผ่านจากทางการกดปุ่ม โดยมีปุ่ม 4 แบบที่ต่างกันคือ A,B,C และ D
ทั้งยังมีปุ่ม Back และ Enter เพื่อใช้ในการลบเมื่อกดผิด และใช้ในการส่งรหัสผ่าน เมื่อพิมพ์ครบ 8 หลัก
เมื่อทำการส่งรหัสผ่านแล้ว จะต้องกดตรวจสอบรหัสผ่านที่หน้าเว็บไซต์ เพื่อรับผลการตรวจรหัสผ่านจากปุ่มกด
ถ้าหากว่าผิด จะมีการแสดงผลที่หน้าจอ LCD ว่ารหัสผ่านผิด และจะกลับไปสู่การทำงานเช่นเดียวกันกับตอนที่เปิดเครื่อง
หากว่าถูกต้อง จะเข้าสู่การรอรหัสผ่านจากหน้าเว็บไซต์
เมื่อทำการกรอกรหัสผ่านจากหน้าเว็บไซต์เพื่อตรวจสอบแล้ว ผลการตรวจจะแสดงที่หน้าจอ LCD
ถ้าหากว่าผิด จะกลับไปสู่การทำงานเช่นเดียวกันกับตอนที่เปิดเครื่อง
หากว่าถูกต้อง ประตูตู้เซฟจะเปิดออกและตู้เซฟจะเข้าสู่การรอการปิดประตูตู้เซฟ
เมื่อทำการปิดประตูตู้เซฟแล้ว จะกลับเข้าสู่การทำงานเช่นเดียวกับตอนที่เปิดเครื่อง

รายการอุปกรณ์ที่ใช้ :
• Raspberry Pi 3 Model B+ พร้อม สาย Adapter Model YM-0530 1 ชุด
• Board NodeMCU - ATmega328p (Practicum Board v3.2 CPE. KU 2020-11) 1 ชุด
• Peripheral board (PRACTICUM PROTOBOARD CPE. KU) 2 ชิ้น
• สายแพ 3 สาย
• Jumper wire Female-Female 6 สาย
• Pin header ที่เพิ่มเข้ามา หลากหลายขนาด ดังนี้
- ขนาด 5x2 : 3 ชิ้น
- ขนาด 1x4 : 1 ชิ้น
- ขนาด 1x3 : 1 ชิ้น
- ขนาด 1x2 : 2 ชิ้น
• Switch button กดติดปล่อยดับแบบ 4 ขา ขนาด 6x6x5 mm 4 ชิ้น
• Switch button กดติดปล่อยดับแบบ 4 ขา ขนาด 6x6x7 mm 2 ชิ้น
• 1602 LCD (Blue Screen) 16x2 LCD with backlight of the LCD screen พร้อม I2CInterface 5V 1 ชุด
• Micro servo SG90 1 เครื่อง
• USB TTL PL2303TA 1 สาย
• Micro switch แบบยาว ขนาด 50 mm 220V 15A พร้อมบัดกรีสายไฟที่ขา C และ NO 1 ชิ้น
• Resistor 10k Ohm 1 ชิ้น

เทคนิคที่ใช้ :
• Backend :
- มีการเก็บ password แบบ encrypt และแยกออกจากไฟล์หลัก เนื่องจากทำการ encrypt ด้วย SHA256 ที่เป็นการทำ encrypted ไปในทางเดียว ไม่สามารถ decrypt ต่อให้คนแฮคสามารถเข้าถึงได้ทั้งสองไฟล์ก็ยังไม่รู้ password อยู่ดี
- การสื่อการกับ frontend ผ่านทาง HTTP request โดยใช้ library flask python
- มีการใช้ shell script ในการวิเคราะห์ข้อมูลเบื้องต้นจาก log file
• Frontend :
- การตรวจสอบ password โดยจะไม่สามารถใส่ช่องว่างได้
- check สถานะว่า hardware กรอกรหัสเข้ามาหรือยังผ่าน HTTP request โดยใช้การ fetch method POST และ GET
• Hardware :
- การแบ่งสถานะการทำงานของ microcontroller ด้วยการใช้ boolean variable ระหว่างสถานะการรอเข้ารหัสผ่าน รอผลลัพธ์การตรวจรหัสผ่าน และการรอปิดตู้เซฟ
- การสื่อสารกับ Backend ผ่านทาง USB driver ด้วย V-USB library ในการส่งรหัสผ่านและรับผลการตรวจรหัสผ่าน
